---
phase: 01-foundation-cleanup
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/App.tsx
  - src/components/Waves.tsx
  - src/components/WavyBackground.tsx
  - eslint.config.js
autonomous: true

must_haves:
  truths:
    - "Wave animations render without glitching (random values stable across renders)"
    - "No console.log statements appear in browser dev tools"
    - "ESLint fails build if console.* appears in src/"
    - "No @ts-expect-error comments remain in codebase"
  artifacts:
    - path: "src/App.tsx"
      provides: "Stable wave noise offsets via useMemo"
      contains: "useMemo"
    - path: "eslint.config.js"
      provides: "no-console rule at error level"
      contains: "no-console"
  key_links:
    - from: "src/App.tsx"
      to: "src/components/WavyBackground.tsx"
      via: "waveNoiseOffsets passed as stable props"
      pattern: "waveNoiseOffsets"
---

<objective>
Fix critical bugs that actively break user experience: stabilize random wave values, remove console.log statements, add ESLint no-console enforcement, and fix TypeScript issues.

Purpose: The random values regenerating every render cause visible stuttering in wave animations. Console.log statements pollute production output. @ts-expect-error comments hide type issues that should be properly resolved.

Output: Stable wave animations, clean production console, strict TypeScript compliance.
</objective>

<execution_context>
@/Users/romatroskin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/romatroskin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-cleanup/01-RESEARCH.md

@src/App.tsx
@src/components/Waves.tsx
@src/components/WavyBackground.tsx
@eslint.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Stabilize random wave values with useMemo</name>
  <files>src/App.tsx</files>
  <action>
Fix the random value regeneration bug in App.tsx.

**Current problem (lines 44-47):**
```typescript
{waveConfigs.map((_, index) => {
    const amplitudeNoise = random(-20, 20);
    const speedNoise = random(-0.005, 0.005);
    const pointsNoise = random(-1, 1);
```

These random values are computed inside the map callback, causing regeneration on every render, which causes wave animation glitching.

**Fix:**
1. Add useMemo import (already has useRef from react)
2. Create a helper function outside the component for random range:
```typescript
function randomRange(min: number, max: number): number {
  return Math.random() * (max - min) + min
}
```

3. Before the return statement, add useMemo to compute stable noise offsets:
```typescript
const waveNoiseOffsets = useMemo(() => {
  return Array.from({ length: numWaves }, () => ({
    amplitude: randomRange(-20, 20),
    speed: randomRange(-0.005, 0.005),
    points: randomRange(-1, 1)
  }))
}, []) // Empty deps - compute once on mount
```

4. In the map callback, replace inline random() calls with:
```typescript
{waveConfigs.map((_, index) => {
    const { amplitude: amplitudeNoise, speed: speedNoise, points: pointsNoise } = waveNoiseOffsets[index]
```

5. Remove the lodash import: `import { random } from "lodash";`

This ensures noise offsets are computed once and remain stable across renders.
  </action>
  <verify>
Run `npm run lint` - no errors related to App.tsx.
Run `npm run build` - builds successfully.
Manually verify: `grep -n "useMemo" src/App.tsx` shows useMemo usage.
Verify: `grep "from 'lodash'" src/App.tsx` returns nothing (import removed).
  </verify>
  <done>Wave noise offsets are memoized and stable across renders. Lodash import removed from App.tsx.</done>
</task>

<task type="auto">
  <name>Task 2: Remove console.log statements from components</name>
  <files>src/components/Waves.tsx</files>
  <action>
Remove console.log statement from Waves.tsx.

**Line 49 in Waves.tsx constructor:**
```typescript
console.log("Wave", { props });
```

Delete this entire line. The Wave component does not need debug logging in production.

Also remove any other console.* statements found in the codebase (check Quotes.tsx line 16 if it still exists - but Quotes is being removed in Plan 03).
  </action>
  <verify>
Run `grep -rn "console\." src/` - should return no results in component files.
  </verify>
  <done>All console.log statements removed from Waves.tsx.</done>
</task>

<task type="auto">
  <name>Task 3: Add ESLint no-console rule at error level</name>
  <files>eslint.config.js</files>
  <action>
Add no-console rule to eslint.config.js to prevent future console.* additions.

In the rules object, add:
```javascript
'no-console': 'error'
```

This makes the build fail if any console.* statement appears in src/ code.

The full rules section should look like:
```javascript
rules: {
  ...reactHooks.configs.recommended.rules,
  'react-refresh/only-export-components': [
    'warn',
    { allowConstantExport: true },
  ],
  'no-console': 'error',
},
```
  </action>
  <verify>
Run `npm run lint` - passes with no errors (since console.logs were removed).
Temporarily add a console.log to a file and run `npm run lint` - should fail.
Remove the temporary console.log after verification.
  </verify>
  <done>ESLint configured to error on console.* statements, preventing future additions.</done>
</task>

<task type="auto">
  <name>Task 4: Fix @ts-expect-error in WavyBackground.tsx</name>
  <files>src/components/WavyBackground.tsx</files>
  <action>
Fix the TypeScript issue in WavyBackground.tsx line 79.

**Current code:**
```typescript
// @ts-expect-error nice to have =p
<AnimatedWave
```

The issue is that AnimatedWave (created via `animated(Wave)`) has type mismatches with the props being spread.

**Solution:**
The problem is likely the `options` prop being spread as individual props. Examine the interface and fix the type:

1. Update the component to properly type the animated component:

```typescript
const WavyBackground = memo(
  React.forwardRef<Wave, WavyBackgroundPropTypes>(
    ({ options, style, ...props }, ref) => (
      <AnimatedWave
        {...options}
        {...props}
        style={{ ...style }}
        ref={ref as React.Ref<Wave>}
      />
    )
  )
)
```

If the ref type is the issue, cast ref to the appropriate type. If it's the spread props, ensure WavesPropTypes matches what AnimatedWave expects.

Alternative if react-spring types are incomplete: Replace @ts-expect-error with a more specific type assertion only if truly necessary, with a clear comment explaining why.

Goal: Remove @ts-expect-error entirely or replace with proper typing.
  </action>
  <verify>
Run `npx tsc --noEmit` - no TypeScript errors.
Run `grep -n "@ts-expect-error" src/` - returns no results.
  </verify>
  <done>@ts-expect-error removed from WavyBackground.tsx with proper typing.</done>
</task>

</tasks>

<verification>
1. `npm run build` completes successfully without warnings
2. `npm run lint` passes with no errors
3. `grep -rn "console\." src/components/` returns no results
4. `grep -n "@ts-expect-error" src/` returns no results
5. Wave animations are visually stable (verify in browser if needed)
</verification>

<success_criteria>
- useMemo stabilizes wave noise offsets in App.tsx
- No console.* statements in src/ directory
- ESLint no-console rule prevents future additions
- No @ts-expect-error comments remain
- Build and lint pass cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-cleanup/01-02-SUMMARY.md`
</output>
