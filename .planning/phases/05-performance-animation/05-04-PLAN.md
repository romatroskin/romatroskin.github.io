---
phase: 05-performance-animation
plan: 04
type: execute
wave: 2
depends_on: ["05-02"]
files_modified:
  - src/App.tsx
  - src/sections/ServicesSection.tsx
  - src/sections/AboutSection.tsx
autonomous: true

must_haves:
  truths:
    - "Below-fold content (pages 2-3) is lazy loaded"
    - "Above-fold content (hero) loads immediately without delay"
    - "Suspense fallback shows loading state for lazy sections"
    - "No flash of unstyled content during lazy load"
  artifacts:
    - path: "src/sections/ServicesSection.tsx"
      provides: "Lazy-loadable services section component"
      exports: ["default"]
    - path: "src/sections/AboutSection.tsx"
      provides: "Lazy-loadable about section component"
      exports: ["default"]
    - path: "src/App.tsx"
      provides: "App with React.lazy for below-fold sections"
      contains: "React.lazy"
  key_links:
    - from: "src/App.tsx"
      to: "src/sections/ServicesSection.tsx"
      via: "React.lazy dynamic import"
      pattern: "lazy.*import.*ServicesSection"
    - from: "src/App.tsx"
      to: "src/sections/AboutSection.tsx"
      via: "React.lazy dynamic import"
      pattern: "lazy.*import.*AboutSection"
---

<objective>
Implement lazy loading for below-fold content to improve initial load performance.

Purpose: Reduce initial bundle size and improve LCP by deferring non-critical content.
Output: Below-fold sections (Services, About) lazy loaded with React.lazy and Suspense.
</objective>

<execution_context>
@/Users/romatroskin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/romatroskin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-performance-animation/05-RESEARCH.md

# Relevant source files
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract below-fold sections into separate files</name>
  <files>
    - src/sections/ServicesSection.tsx
    - src/sections/AboutSection.tsx
  </files>
  <action>
    Create src/sections/ directory and extract the below-fold content from App.tsx.

    1. Create src/sections/ServicesSection.tsx:
       ```typescript
       interface ServicesSectionProps {
         onNavigate: (page: number) => void;
       }

       export default function ServicesSection({ onNavigate }: ServicesSectionProps) {
         return (
           <section id="services-section" aria-labelledby="services-heading">
             <div className="intro-container content-card">
               <h2 id="services-heading" className="section-title">Craft Applications Workshop</h2>
               <p className="intro-text">
                 Are you seeking to bring your mobile application idea to life
                 with seamless precision and stunning user experiences?
               </p>
               <p className="intro-text">
                 Look no further than <strong>Puff Puff Dev</strong>, your
                 dedicated partner in crafting exceptional mobile applications
                 using the latest Flutter technologies.
               </p>
               <div className="cta-buttons">
                 <button
                   className="cta-primary"
                   onClick={() => onNavigate(2)}
                 >
                   Learn More About Us
                 </button>
               </div>
             </div>
           </section>
         );
       }
       ```

    2. Create src/sections/AboutSection.tsx:
       ```typescript
       export default function AboutSection() {
         return (
           <section id="about-section" aria-labelledby="about-heading">
             <div className="about-container content-card">
               <h2 id="about-heading" className="section-title">About Us</h2>
               <div className="about-content">
                 <p className="about-text">
                   At Puff Puff Dev, we are dedicated to crafting exceptional
                   mobile applications that bring your ideas to life. With a
                   team of experienced developers and designers, we leverage
                   the latest technologies, primarily focusing on Flutter and
                   Dart, to deliver seamless user experiences and innovative
                   solutions.
                 </p>
                 <p className="about-text">
                   Our mission is to transform your dreams into reality
                   through creative coding, attention to detail, and a
                   commitment to quality. Whether you're a startup looking to
                   build your first app or an established business seeking to
                   enhance your digital presence, we are here to help you
                   every step of the way.
                 </p>
                 <p className="about-text highlight">
                   Join us on this exciting journey as we explore the endless
                   possibilities of mobile development together!
                 </p>
               </div>
             </div>
           </section>
         );
       }
       ```

    NOTE: These are extracted directly from the current App.tsx JSX. The CSS classes
    (intro-container, content-card, section-title, etc.) are already defined in App.css.
  </action>
  <verify>
    - File exists: src/sections/ServicesSection.tsx
    - File exists: src/sections/AboutSection.tsx
    - Both files export default functions
    - `npm run build` succeeds (files compile)
  </verify>
  <done>
    - ServicesSection extracted with onNavigate prop
    - AboutSection extracted as standalone component
    - Both ready for lazy loading
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement React.lazy and Suspense in App.tsx</name>
  <files>
    - src/App.tsx
  </files>
  <action>
    Update App.tsx to lazy load the below-fold sections.

    1. Add React.lazy imports at top of file (after other imports):
       ```typescript
       import { useRef, useMemo, useState, useEffect, useCallback, lazy, Suspense } from "react";

       // Lazy load below-fold sections (pages 2-3)
       const ServicesSection = lazy(() => import('./sections/ServicesSection'));
       const AboutSection = lazy(() => import('./sections/AboutSection'));
       ```

    2. Create a simple loading fallback component (inside App.tsx or extract):
       ```typescript
       function SectionLoader() {
         return (
           <div className="section-loader content-card" aria-busy="true" aria-label="Loading section">
             <div className="loader-text">Loading...</div>
           </div>
         );
       }
       ```

    3. Replace inline JSX for pages 2-3 with lazy-loaded components wrapped in Suspense:

       For Page 2 (Services), replace the inline section with:
       ```tsx
       <ParallaxLayer
         offset={1}
         speed={0.3}
         style={{
           display: "flex",
           alignItems: "center",
           justifyContent: "center",
         }}
       >
         <Suspense fallback={<SectionLoader />}>
           <ServicesSection onNavigate={scrollToPage} />
         </Suspense>
       </ParallaxLayer>
       ```

       For Page 3 (About), replace the inline section with:
       ```tsx
       <ParallaxLayer
         offset={2}
         speed={0.4}
         style={{
           display: "flex",
           alignItems: "center",
           justifyContent: "center",
         }}
       >
         <Suspense fallback={<SectionLoader />}>
           <AboutSection />
         </Suspense>
       </ParallaxLayer>
       ```

    4. Add CSS for the loader in App.css (or use existing content-card styling):
       ```css
       .section-loader {
         display: flex;
         align-items: center;
         justify-content: center;
         min-height: 200px;
       }

       .loader-text {
         color: var(--color-text-secondary);
         font-size: 1rem;
       }
       ```

    IMPORTANT:
    - Keep the hero section (page 1) as inline JSX - it's above the fold and is the LCP
    - Only lazy load pages 2 and 3 (below fold)
    - The Suspense boundary is per-section so they can load independently
  </action>
  <verify>
    - App.tsx imports lazy and Suspense from React
    - App.tsx has lazy(() => import()) calls for ServicesSection and AboutSection
    - Pages 2-3 wrapped in Suspense with fallback
    - Hero section (page 1) still renders inline (not lazy)
    - `npm run dev` works - scroll to page 2 loads ServicesSection
    - `npm run build` succeeds
    - Build output shows separate chunks for sections (check dist/assets/)
  </verify>
  <done>
    - Below-fold sections lazy loaded with React.lazy
    - Suspense fallback shows loading state
    - Above-fold hero loads immediately
    - Bundle split into separate chunks for deferred content
  </done>
</task>

</tasks>

<verification>
Run verification sequence:

1. Build verification:
   - `npm run build` succeeds
   - Check dist/assets/ for separate chunk files (should see ServicesSection and AboutSection chunks)

2. Runtime verification:
   - `npm run dev`
   - Open DevTools Network tab
   - On initial load, only main bundle loads
   - Scroll to page 2 - see ServicesSection chunk load
   - Scroll to page 3 - see AboutSection chunk load

3. LCP verification:
   - Hero section renders immediately (no flash)
   - Lighthouse LCP should not be affected (hero is not lazy)

4. Accessibility:
   - SectionLoader has aria-busy and aria-label
   - No content shift when sections load
</verification>

<success_criteria>
- src/sections/ServicesSection.tsx exists and exports default
- src/sections/AboutSection.tsx exists and exports default
- App.tsx uses React.lazy for both section imports
- App.tsx wraps lazy sections in Suspense with fallback
- Hero section (page 1) is NOT lazy loaded
- Build produces separate chunks for lazy sections
- No flash of unstyled content during lazy load
- Lighthouse performance score maintained or improved
</success_criteria>

<output>
After completion, create `.planning/phases/05-performance-animation/05-04-SUMMARY.md`
</output>
