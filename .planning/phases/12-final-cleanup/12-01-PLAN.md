---
phase: 12-final-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - eslint.config.js
  - src/performance/vitals.ts
  - src/components/common/ErrorBoundary/WaveAnimationFallback.tsx
  - src/hooks/useAnimationFrame.test.ts
  - src/hooks/usePerlinNoise.test.ts
  - src/hooks/useScrollSpy.test.ts
autonomous: true

must_haves:
  truths:
    - "npm run lint returns 0 errors"
    - "npm run lint returns 0 warnings"
    - "All 116+ tests still pass"
    - "ESLint config allows console.warn and console.error for monitoring purposes"
    - "No unused source files exist in src/"
    - "No dead code (unreachable blocks, unused exports) exists"
    - "No orphaned imports (imports of non-existent files) exist"
  artifacts:
    - path: "eslint.config.js"
      provides: "Updated lint rules with underscore ignore pattern and console.warn/error allowed"
      contains: "argsIgnorePattern"
    - path: "src/performance/vitals.ts"
      provides: "Fixed unused expression error"
      contains: "void"
    - path: "src/hooks/useScrollSpy.test.ts"
      provides: "Proper types replacing any"
      contains: "MockIntersectionObserverConstructor"
  key_links: []
---

<objective>
Fix all 17 ESLint errors and 2 warnings through direct code fixes and ESLint configuration updates.

Purpose: Achieve zero lint errors/warnings for clean production codebase (Phase 12 success criteria #4)
Output: Clean lint output with no errors or warnings
</objective>

<execution_context>
@/Users/romatroskin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/romatroskin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-final-cleanup/12-RESEARCH.md

Current lint status (19 problems: 17 errors, 2 warnings):
- Console statements: 8 errors across vitals.ts, loafMonitor.ts, ErrorBoundary.tsx, ErrorBoundary.test.tsx
- Unused variables: 5 errors in test files and WaveAnimationFallback.tsx
- Unused expression: 1 error in vitals.ts line 15
- `any` types: 3 errors in useScrollSpy.test.ts
- React-refresh warnings: 2 warnings in Header.tsx and ErrorBoundary.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update ESLint Configuration</name>
  <files>eslint.config.js</files>
  <action>
Update eslint.config.js rules section to:

1. Allow console.warn and console.error (for legitimate monitoring):
   ```javascript
   'no-console': ['error', { allow: ['warn', 'error'] }],
   ```

2. Configure underscore prefix pattern for intentionally unused variables:
   ```javascript
   '@typescript-eslint/no-unused-vars': [
     'error',
     {
       argsIgnorePattern: '^_',
       varsIgnorePattern: '^_',
       caughtErrorsIgnorePattern: '^_',
     }
   ],
   ```

3. Update react-refresh rule to allow constant exports (already set, but verify `allowConstantExport: true` handles the Header.tsx navItems export).

This addresses:
- 6 console.warn/error statements in monitoring code (vitals.ts, loafMonitor.ts, ErrorBoundary.tsx)
- _props unused variable in WaveAnimationFallback.tsx (already prefixed with underscore)
  </action>
  <verify>npm run lint (still shows remaining errors to fix manually)</verify>
  <done>ESLint config updated with console.warn/error allowed and underscore pattern for unused vars</done>
</task>

<task type="auto">
  <name>Task 2: Fix Remaining Code Lint Errors</name>
  <files>
    src/performance/vitals.ts
    src/hooks/useAnimationFrame.test.ts
    src/hooks/usePerlinNoise.test.ts
    src/hooks/useScrollSpy.test.ts
    src/components/common/ErrorBoundary/ErrorBoundary.test.tsx
  </files>
  <action>
Fix remaining lint errors that cannot be resolved via config:

1. **vitals.ts line 15** - Unused expression error:
   Change:
   ```typescript
   navigator.sendBeacon?.('/analytics', body) ||
     fetch('/analytics', { body, method: 'POST', keepalive: true });
   ```
   To:
   ```typescript
   void (navigator.sendBeacon?.('/analytics', body) ||
     fetch('/analytics', { body, method: 'POST', keepalive: true }));
   ```

2. **useAnimationFrame.test.ts**:
   - Line 2: Remove unused `act` import (change `{ renderHook, act }` to `{ renderHook }`)
   - Line 20: Prefix `id` parameter with underscore: `(_id) => {`

3. **usePerlinNoise.test.ts lines 79-80**:
   Remove unused value1/value2 variables or use them in assertion.
   The test at lines 76-83 already has meaningful assertion (result1.current !== result2.current).
   Remove the unused value1/value2 declarations since they add no value:
   ```typescript
   // Lines 79-80 should be deleted - they're redundant with line 83's assertion
   ```

4. **useScrollSpy.test.ts lines 10, 20, 29** - Replace `any` types:
   - Line 10: `let mockIntersectionObserver: any;`
     Change to: `let mockIntersectionObserver: MockIntersectionObserverConstructor;`
   - Line 20: `this: any`
     Change to: `this: MockIntersectionObserverInstance`
   - Line 29: `as any`
     Change to: `as unknown as typeof IntersectionObserver`

   Add type definitions at top of file after imports:
   ```typescript
   interface MockIntersectionObserverInstance {
     observe: ReturnType<typeof vi.fn>;
     unobserve: ReturnType<typeof vi.fn>;
     disconnect: ReturnType<typeof vi.fn>;
   }

   type MockIntersectionObserverConstructor = new (
     callback: IntersectionObserverCallback,
     options?: IntersectionObserverInit
   ) => MockIntersectionObserverInstance;
   ```

5. **ErrorBoundary.test.tsx lines 30, 32, 36** - Console statements in test:
   These are test setup lines that mock console.error. After ESLint config change to allow console.error, only line 32 (assignment to console.error) may still error.
   - If still erroring, update the mock pattern:
     Line 32: `console.error = vi.fn();`
     This direct assignment triggers no-console. Instead use:
     ```typescript
     vi.spyOn(console, 'error').mockImplementation(() => {});
     ```
   - Line 36: `console.error = originalError;`
     Change to restoration pattern or keep original spyOn mock that auto-restores.
  </action>
  <verify>npm run lint && npm test</verify>
  <done>All lint errors fixed, tests passing</done>
</task>

<task type="auto">
  <name>Task 3: Fix React-Refresh Warnings</name>
  <files>
    src/components/ui/Header/Header.tsx
    src/components/ui/Header/Header.types.ts
    src/components/common/ErrorBoundary/ErrorBoundary.tsx
    src/utils/errorLogging.ts
  </files>
  <action>
Fix the 2 react-refresh warnings by extracting non-component exports:

1. **Header.tsx line 19** - Extract navItems constant:
   - Create new file `src/components/ui/Header/Header.types.ts`
   - Move NavItem interface and navItems array to this file
   - Export both from Header.types.ts
   - Update Header.tsx to import from './Header.types'
   - Update any other files importing navItems from Header.tsx

2. **ErrorBoundary.tsx line 20** - Extract logErrorInDev function:
   - Create new file `src/utils/errorLogging.ts`
   - Move logErrorInDev function to this file
   - Export from errorLogging.ts
   - Update ErrorBoundary.tsx to re-export from errorLogging.ts for backward compatibility:
     `export { logErrorInDev } from '@/utils/errorLogging';`
   - This maintains the existing import API while satisfying react-refresh

Note: The react-refresh rule has `allowConstantExport: true`, so the Header.tsx warning for navItems may already be suppressed. Verify after config update - if no warning, skip Header.tsx extraction.
  </action>
  <verify>npm run lint (should show 0 errors, 0 warnings)</verify>
  <done>Zero lint errors and zero warnings achieved</done>
</task>

<task type="auto">
  <name>Task 4: Scan and Remove Dead Code</name>
  <files>
    src/**/*.ts
    src/**/*.tsx
  </files>
  <action>
Systematically verify no dead code exists (REQ-02 coverage):

1. **Check for unused source files:**
   Run a scan to find all .ts/.tsx files in src/ and verify each is imported somewhere:
   ```bash
   # List all source files
   find src -name "*.ts" -o -name "*.tsx" | grep -v ".test." | grep -v ".d.ts"

   # For each file, grep if it's imported anywhere (check filename without extension)
   ```

   Alternatively use ESLint's unused-imports or a tool like ts-prune:
   ```bash
   npx ts-prune --project tsconfig.json 2>/dev/null || echo "Manual review needed"
   ```

2. **Check for unused exports:**
   ESLint with `@typescript-eslint/no-unused-vars` at error level already flags unused local variables.
   For exports, verify each export is imported somewhere in the codebase.

3. **Check for orphaned imports:**
   TypeScript compilation (`npm run build`) will fail if importing non-existent files.
   Additionally verify no commented-out import statements remain.

4. **Review TODO/FIXME comments:**
   ```bash
   grep -r "TODO\|FIXME\|HACK\|XXX" src/ --include="*.ts" --include="*.tsx"
   ```
   Document any findings; do not remove legitimate TODOs but flag if any mark dead code.

5. **Verify no unreachable code:**
   ESLint's no-unreachable rule (default in recommended config) catches unreachable code blocks.
   Confirm `npm run lint` passes with no unreachable code warnings.

If any dead code is found:
- Remove unused files entirely
- Remove unused exports
- Clean up orphaned imports
- Document in SUMMARY what was removed
  </action>
  <verify>npm run build succeeds (TypeScript catches orphaned imports) && npm run lint (ESLint catches unused vars)</verify>
  <done>No unused source files, dead code, or orphaned imports exist in src/</done>
</task>

</tasks>

<verification>
1. `npm run lint` exits with code 0 and shows no errors or warnings
2. `npm test` passes all 116+ tests
3. `npm run build` completes without errors
</verification>

<success_criteria>
- ESLint returns clean output with 0 errors and 0 warnings
- All existing tests pass (116+)
- Build succeeds
- Console.warn/error allowed for monitoring code paths
- Underscore prefix pattern works for intentionally unused parameters
</success_criteria>

<output>
After completion, create `.planning/phases/12-final-cleanup/12-01-SUMMARY.md`
</output>
